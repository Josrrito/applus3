# APPLUS3

**Context-Aware Multi-IA Code Generation with Knowledge Graph**

Generated by combining:
- **Idea2Paper** analysis methodology (Knowledge Graph + Anchored Review)
- **APPLUS-WEBAPP** Multi-IA consensus (GPT-4o + Claude + DeepSeek)

## Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                         APPLUS3                                  │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────┐    │
│  │              KNOWLEDGE GRAPH (Single Source of Truth)    │    │
│  │  Nodes: Functions, Classes, Modules, Patterns            │    │
│  │  Edges: DEPENDS_ON, IMPLEMENTS, USES_PATTERN, EXPORTS    │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              ↕                                   │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                    ORCHESTRATOR                          │    │
│  │  • Sequences M0 → M1 → M2                                │    │
│  │  • Passes KG context between stages                      │    │
│  │  • Validates outputs with Anchored Review                │    │
│  └─────────────────────────────────────────────────────────┘    │
│                              ↓                                   │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐                       │
│  │    M0    │  │    M1    │  │    M2    │                       │
│  │ Analysis │→ │ CodeGen  │→ │ Deploy   │                       │
│  │ (Ideas)  │  │(AgentCod)│  │ (Config) │                       │
│  └──────────┘  └──────────┘  └──────────┘                       │
└─────────────────────────────────────────────────────────────────┘
```

## Key Features

### From Idea2Paper
- **Knowledge Graph**: Persistent memory of generated components
- **Anchored Review**: Validate code against anchor examples
- **Context Retrieval**: BFS-based dependency chain traversal

### From APPLUS-WEBAPP
- **Multi-IA Consensus**: GPT-4o + Claude + DeepSeek voting
- **RSA Synthesis**: Combine responses when no consensus
- **Semantic Evaluation**: Meta-IA evaluates equivalence

## Quick Start

```bash
# Install dependencies
pip install -r requirements.txt

# Run the API
uvicorn api.main:app --reload

# Or with Python
python -m api.main
```

## API Endpoints

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/generate` | POST | Start code generation |
| `/status/{id}` | GET | Check generation status |
| `/result/{id}` | GET | Get generated code |
| `/kg/stats` | GET | Knowledge Graph stats |
| `/kg/nodes` | GET | List KG nodes |
| `/health` | GET | Health check |

## Example Usage

```bash
# Generate code for a new project
curl -X POST "http://localhost:8000/generate" \
  -H "Content-Type: application/json" \
  -d '{"idea": "Create a REST API for user management with authentication"}'

# Check status
curl "http://localhost:8000/status/{request_id}"

# Get result
curl "http://localhost:8000/result/{request_id}"
```

## Project Structure

```
applus3/
├── api/
│   └── main.py              # FastAPI entry point
├── orchestrator/
│   ├── orchestrator.py      # Central brain
│   ├── knowledge_graph.py   # KG storage
│   ├── retrieval.py         # Context retrieval
│   └── anchored_review.py   # Validation
├── workers/
│   ├── m0_worker.py         # Analysis
│   ├── m1_worker.py         # Code generation
│   └── m2_worker.py         # Deployment
├── runs/                    # Generation outputs
├── requirements.txt
└── README.md
```

## How Context is Maintained

1. **M0 Analysis**: Parses idea, creates KG nodes for each component
2. **Dependency Order**: Topological sort ensures dependencies generated first
3. **Context Chain**: Each M1 call receives:
   - Component specification
   - KG context (related nodes/edges)
   - Previously generated code
4. **Anchored Review**: Validates coherence across all generated files

## Environment Variables

```bash
# Optional: Override default backend
APPLUS_BACKEND_URL=https://applus-webapp-backend.onrender.com

# For local Multi-IA (if running own backend)
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
DEEPSEEK_API_KEY=sk-...
```

## Generated by

This project demonstrates the hybrid approach:
- **Idea2Paper** provides the methodology (KG + Anchored Review)
- **APPLUS-WEBAPP** provides the execution (Multi-IA consensus)
- **Claude Code** orchestrates the generation

## License

MIT
